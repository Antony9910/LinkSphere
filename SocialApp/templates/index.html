<!DOCTYPE html>
{%load static%}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <title>Document</title>
</head>
 
<body>
    {% comment %} <div>
        <nav class="bg-dark text-white d-flex p-3 mb-3" style="width:100rem;margin-right:700px">
            <div >
        <h6 >LINKSPHERE</h6>
            </div>
            <div>
            <div style="margin-left:770px" class="d-flex">
                  
          <div>
         <a href="{% url 'profile-detail' user.Profile.pk %}" class="btn btn-primary">View Profile<i class="fa-solid fa-eye"></i></a></div>
                 <div style="margin-left:2px"> <a href="{%url 'profile-update' request.user.Profile.id %}" class="btn btn-success">Edit-Profile<i class="fa-solid fa-user-pen"></i></a> </div>

   
         <div>
         <a href="{% url 'profileList'%}" class="btn btn-warning">View Profiles<i class="fa-solid fa-eye"></i></a></div>
        <div>
        <a href="{% url 'signout' %}" class="btn btn-danger text-white">
  Signout {{ request.user }}<i class="fa-solid fa-right-from-bracket"></i>
</a>
</div> {% endcomment %}
<nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">LINKSPHERE</a><img src="{% static "social/images/Logo.png" %}" class="rounded-circle" alt="logo" width="50"height="50">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{%url 'Index'%}">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'profileList'%}">Profile</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Dropdown
          </a>
          <ul class="dropdown-menu">
             <li><a class="dropdown-item" href="{% url 'profile-detail' user.Profile.pk %}">{{request.user}} Profile</a></li>
            <li><a class="dropdown-item" href="{% url 'profileList'%}">View Profiles</a></li>
           <li><a class="dropdown-item" href="{%url 'profile-update' request.user.Profile.id %}">Edit-Profile</a></li>
           
          </ul>
        </li>
       
      </ul>
      <button type="button" class="btn btn-primary" style="margin-right:5px" data-bs-toggle="modal" data-bs-target="#exampleModal">
Add Post
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" class="margin-left:10px" id="exampleModalLabel">Add Your Post</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form action=" " method="post" enctype="multipart/form-data">
        {%csrf_token%}
      <div class="modal-body">
       <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1">@</span>
  <input type="text" class="form-control" placeholder="Post Your Post Title" name="title" aria-label="Username" aria-describedby="basic-addon1">
</div>
<div class="input-group mb-3">
  <label class="input-group-text" for="inputGroupFile01">Upload</label>
  <input type="file" class="form-control"name="post_image" id="inputGroupFile01" accept="image/*">
</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Save changes</button>
      </div>
    </form>
    </div>
  </div>
</div>
      <!-- Button trigger modal -->
<button type="button" class="btn btn-primary" style="margin-right:5px" data-bs-toggle="modal" data-bs-target="#exampleModal">
Add Story
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" class="margin-left:10px" id="exampleModalLabel">Post Your Story</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form action="{%url 'story' %}" method="post" enctype="multipart/form-data">
        {%csrf_token%}
      <div class="modal-body">
       <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1">@</span>
  <input type="text" class="form-control" placeholder="Post Your Story Title" name="text" aria-label="Username" aria-describedby="basic-addon1">
</div>
<div class="input-group mb-3">
  <label class="input-group-text" for="inputGroupFile01">Upload</label>
  <input type="file" class="form-control"name="post_image" id="inputGroupFile01" accept="image/*">
</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Save changes</button>
      </div>
    </form>
    </div>
  </div>
</div>
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
        <button class="btn btn-outline-success" type="submit">Search</button>
         <a href="{% url 'signout' %}" class="btn text-white bg-primary">
  Signout
</a>
      </form>
      
 {% if request.user.Profile.profilePic %}
  <img src="{{ request.user.Profile.profilePic.url }}" class="rounded-circle" alt="User Avatar" width="50" height="50">
{% else %}
  <img src="{% static 'social/images/login.png' %}" class="rounded-circle" alt="Default Avatar" width="50" height="50">
{% endif %}
    </div>
  </div>
</nav>

<div>
      
     
        </nav>
       
    </div>

   <div>

 <div class="d-flex">
  {% if request.user.Profile.profilePic %}
    <div class="text-center mx-1" style="width: 60px;">
      <img src="{{ request.user.Profile.profilePic.url }}" class="rounded-circle" alt="User Avatar" width="50" height="50">
      <div style="font-size: 12px;">Your Story</div>
    </div>
  {% endif %}

  {% for st in stories %}
    <div class="text-center mx-1" style="width: 60px;">
      <img src="{{ st.post_image.url }}" class="rounded-circle" alt="Avatar" width="50" height="50">
      <div style="font-size: 12px;">{{ st.user }}</div>
    </div>
  {% endfor %}
</div>

{% comment %} 
    <form action="" method="post" enctype="multipart/form-data">
        {%csrf_token%}
    
        <h6 style="margin-left:600px;margin-top:4px">USER-POST<i class="fa-solid fa-user-minus"></i></h6>
        <div class="card mt-3"style="width:25rem;margin-left:500px">
       
  <div class="card-body">
     <div class="input-group flex-nowrap">
  <span class="input-group-text" id="addon-wrapping"><i class="fa-solid fa-user-minus"></i></span>
  <input type="text" class="form-control" placeholder="Enter title of post" name="title" aria-label="Username" aria-describedby="addon-wrapping">
</div>
<div class="input-group mb-3">
  <input type="file" class="form-control mt-3" id="inputGroupFile02" name="post_image" accept="image/*">

</div>
    <button type="submit" class="btn btn-primary" style="margin-left:90px">Add Post</button>
  </div>
</div>
       
    </form> {% endcomment %}
    
 
  <div class="container mt-4">
  <div class="row">
    
    {% for profile in data %}
  
    <div class="col-md-4 mb-4">
      <div class="card mt-5" style="width: 100%;">
       
        <div class="d-flex">
         {% if request.user.Profile.profilePic %}
  <img src="{{ request.user.Profile.profilePic.url }}" class="rounded-circle" alt="User Avatar" width="50" height="50"><div style="margin-top:10px;margin-left:10px">{{request.user}}</div><div style="margin-top:10px;margin-left:10px">{{profile.created_date}}</div>
        </div>
{% else %}
  <img src="{% static 'social/images/login.png' %}" class="rounded-circle" alt="Default Avatar" width="50" height="50">
{% endif %}

        {%if profile.post_image%}
    <img src="{{profile.post_image.url}}" class="card-img-top h-auto w-100">
    {%else%}
  <img src="{% static "social/images/profilepic.jpg" %}" class="card-img-top" alt="Antony's application photo" >
  {%endif%}
        <div class="card-body">

          Caption:{{profile.title}}
          
      
        </div>
     <form action="{% url 'like' profile.id  %}" method="post">

        {%csrf_token%}
        <div style="margin-left:17px;margin-top:-11px">
          {%if request.user in profile.liked_by.all%}
       <button type="submit"name="action"class="btn"value="dislike"><i class="fa-solid fa-heart-crack" style="color: red;"></i></button>
           {%else%}    
           <button type="submit" class="btn"name="action"value="like"><i class="fa-solid fa-heart" style="color: red;"></i> {{profile.liked_by.count}} Likes</button>

 
          {%endif%}
       
         
          <i class="fa-regular fa-comment"></i> {{profile.post_comments.count}} comments
        </div>
         {%for comm in profile.post_comments.all%}
    {% comment %} {{comm.text}} {% endcomment %}
    <div class="input-group mb-3">
  <span class="input-group-text" id="basic-addon1">
     {%if comm.user.Profile.profilePic%}
          <img src="{{ comm.user.Profile.profilePic.url }}" class="rounded-circle" alt="User Avatar" width="50" height="50">

            
     {%endif%}
  </span>
  <input type="text" class="form-control" placeholder="Username"value="{{comm.text}}" aria-label="Username" aria-describedby="basic-addon1"disabled>
   <div>
       {%if u.user.Profile.profilePic%}
             <img src="{{u.Profile.profilePic.url}}" class="rounded-circle" alt="User Avatar" width="30" height="90">
             {%endif%}
    </div>
</div>
    {% endfor %}
   
      </form>
    
      <form action="{%url 'comment' profile.id %}" method="post">
          {%csrf_token%}
        <div class="input-group mt-3">
         <span class="input-group-text" id="basic-addon1">
     {%if  request.user.Profile.profilePic%}
          <img src="{{  request.user.Profile.profilePic.url}}" class="rounded-circle" alt="User Avatar" width="50" height="50">

            
     {%endif%}
         </span>
  <input type="text" class="form-control"name="text" placeholder="Comment"  aria-label="Recipient’s username" aria-describedby="button-addon2">
  <button class="btn btn-primary" type="submit" id="button-addon2">Post</button>
  {{comm.text}}
</div>
</form>

      </div>
    </div>
    {% endfor %}
   
  </div>

   
</body>
</html>